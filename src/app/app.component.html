<ion-app>
  <ion-toast></ion-toast>
  <app-nav-lateral [contentId]="'main-content'" [title]="'Menú'">
    <!-- Información del usuario en la navegación -->
    <div user-info>
      <div *ngIf="currentUser$ | async as usuario" class="user-info-section">
        <ion-item>
          <ion-avatar slot="start" *ngIf="usuario.tieneFoto">
            <img [src]="usuario.foto_url" [alt]="usuario.nombreCompleto">
          </ion-avatar>
          <ion-avatar slot="start" *ngIf="!usuario.tieneFoto">
            <div class="avatar-placeholder">
              {{ usuario.nombre.charAt(0) }}{{ usuario.apellido.charAt(0) }}
            </div>
          </ion-avatar>
          <ion-label>
            <h3>{{ usuario.nombreCompleto }}</h3>
            <p>{{ usuario.perfil }}</p>
          </ion-label>
        </ion-item>
        <hr class="divider">
      </div>
    </div>

    <!-- Elementos de menú dinámicos según el perfil -->
    <ion-list>
      <ng-container *ngIf="currentUser$ | async as usuario">
        <ion-item 
          *ngFor="let menuItem of getMenuItems(usuario.perfil)" 
          button 
          menuClose
          (click)="navigateToRoute(menuItem.route)">
          <ion-icon [name]="menuItem.icon" slot="start"></ion-icon>
          <ion-label>{{ menuItem.label }}</ion-label>
        </ion-item>
      </ng-container>
      
      <!-- Botón de cerrar sesión (siempre visible para usuarios autenticados) -->
      <ng-container *ngIf="currentUser$ | async">
        <hr class="divider">
        <ion-item button menuClose (click)="logout()">
          <ion-icon name="log-out-outline" slot="start"></ion-icon>
          <ion-label>Cerrar Sesión</ion-label>
        </ion-item>
      </ng-container>
    </ion-list>
  </app-nav-lateral>
  
  <ion-router-outlet id="main-content"></ion-router-outlet>
  <app-splash *ngIf="showSplash" (done)="onSplashDone()"></app-splash>
  
  <!-- Toast para notificaciones globales -->

</ion-app>
